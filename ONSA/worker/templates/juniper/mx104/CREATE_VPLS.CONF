{% if vrf_exists is not True %}
set routing-instances {{ vrf_name }} route-distinguisher {{ loopback }}:{{ vpn_id }}
set routing-instances {{ vrf_name }} vrf-target target:{{ as_number }}:{{ vpn_id }}
{% endif %}

{% if pop_size == "large" %}
set interfaces {{ an_uplink_interface }}.{{ logical_unit }} description "{{ an_interface_description }}"
set interfaces {{ an_uplink_interface }}.{{ logical_unit }} encapsulation vlan-vpls
set interfaces {{ an_uplink_interface }}.{{ logical_unit }} vlan-tags outer {{ provider_vlan }}
set interfaces {{ an_uplink_interface }}.{{ logical_unit }} vlan-tags inner {{ service_vlan }}
set routing-instances {{ vrf_name }} interface {{ an_uplink_interface }}.{{ logical_unit }}
set routing-instances {{ vrf_name }} protocols vpls site SITE interface ae1.{{ logical_unit }}

{% elif pop_size == "small" %}
set interfaces {{ an_uplink_interface }} unit {{ logical_unit }} description "{{ an_interface_description }}"
set interfaces {{ an_uplink_interface }}.{{ logical_unit }} encapsulation vlan-vpls
set interfaces {{ an_uplink_interface }} unit {{ logical_unit }} vlan-id {{ service_vlan }}
set routing-instances {{ vrf_name }} interface {{ an_uplink_interface }}.{{ logical_unit }}
set routing-instances {{ vrf_name }} protocols vpls site SITE interface {{ an_uplink_interface }}.{{ logical_unit }}
{% endif %}